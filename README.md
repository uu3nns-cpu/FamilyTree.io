# 결속 (Gyeolsok)

**가족 관계도(Genogram) 제작 웹 애플리케이션**

결속(結束)은 '관계를 맺어 단결함'을 의미하며, 가족의 관계를 시각화하여 이해를 돕는 전문 도구입니다.

---

## ✨ 주요 기능

### 📊 **Genogram 표준 준수**
- 전문적인 가족 관계도 표기법 (Genogram Standards)
- 혼인 관계, 자녀 관계, 형제 관계 표현
- 성별 구분 (사각형: 남성, 원: 여성, 다이아몬드: 미상)
- 사망 표시 (X 표시)
- CT(주요인물) 표시

### 💙 **감정선(Emotional Lines)**
- 8가지 감정 관계 표현
  - 친밀함 (Close)
  - 사랑/애정 (Love/Affection)
  - 소원함 (Distant)
  - 단절 (Cutoff)
  - 갈등 (Conflict)
  - 적대적 (Hostile)
  - 융합 (Fused/Enmeshed)
  - 학대 (신체적/정서적/성적) 및 방임

### 🎯 **인물 관리**
- 인물 추가/편집/삭제
- 이름, 성별, 나이(생년월일) 입력
- CT(주요인물) 및 사망 상태 관리
- 드래그로 위치 이동
- 멀티 셀렉트 및 그룹 이동

### 🔗 **관계선 관리**
- 우클릭 컨텍스트 메뉴로 빠른 가족 추가
  - 부모, 배우자, 자녀, 형제자매
- 자동 관계선 연결
- 관계선 선택 및 삭제
- Genogram 표준 스타일 (실선, 점선 등)

### 🎨 **캔버스 조작**
- 무한 캔버스 (팬/줌)
- 그리드 표시 (점선/실선/없음)
- 스페이스바 임시 팬 모드
- 박스 셀렉트 (드래그로 여러 인물 선택)
- 자석 모드 (그리드 스냅)

### 🤖 **자동 정렬**
- 세대별 수평 정렬
- 가족 그룹별 정렬
- 세대 간격 및 인물 간격 자동 계산
- 화면 중앙 자동 맞춤

### 📤 **내보내기**
- PNG 이미지 내보내기
  - 가계도만 / 가계도+범례 / 범례만
  - 배경색 선택 (투명/흰색/검정)
  - 여백 설정
- PDF 문서 내보내기
  - A4 페이지 크기
  - 프로젝트 정보 포함

### 💾 **프로젝트 관리**
- 프로젝트 생성/편집/삭제
- 일시저장 및 불러오기
- 자동 저장 (10초/30초/1분/5분)
- LocalStorage 기반 로컬 저장

### 📋 **템플릿**
- 7가지 미리 구성된 템플릿
  - 핵가족 (4인)
  - 3세대 가족 (10인)
  - 확대가족 (8인)
  - 재혼 가족 (7인)
  - 2가계 연결 (8인)
  - 기본 튜토리얼
  - 고급 튜토리얼

### 🎓 **튜토리얼 시스템**
- 단계별 가이드
- 하이라이트 및 화살표 표시
- 자동 완료 검증
- 건너뛰기/재시작 가능

### ⏪ **실행 취소/다시 실행**
- 최대 50단계 히스토리 관리
- Ctrl+Z / Ctrl+Shift+Z 단축키
- 모든 작업 추적

### ⚙️ **설정**
- 표시 옵션 (이름/나이/사망/감정선/그리드)
- 캔버스 설정 (선 두께/감정선 두께/투명도)
- 자석 모드
- 자동 저장 간격

### ⌨️ **키보드 단축키**
- **도구**: V(선택), H(팬), P(인물), R(관계)
- **편집**: Delete(삭제), Ctrl+Z(실행취소), Ctrl+Shift+Z(재실행)
- **기타**: 스페이스바(임시 팬), 더블클릭(편집)

### 🎨 **테마**
- 다크 모드 (기본)
- CSS 변수 기반 커스터마이징
- 플랫 미니멀리스트 디자인

---

## 🚀 빠른 시작

### 1. 서버 실행
```bash
# Python 사용 (권장)
start.bat

# 또는 직접 실행
python -m http.server 8000
```

### 2. 브라우저 열기
```
http://localhost:8000
```

### 3. 프로젝트 시작
1. "새 프로젝트 만들기" 클릭
2. 템플릿 선택 또는 빈 프로젝트 시작
3. 캔버스에서 편집 시작!

---

## 📁 프로젝트 구조

```
files/
├── index.html              # 메인 페이지 (프로젝트 목록)
├── canvas.html             # 캔버스 페이지 (가계도 작성)
├── start.bat               # 개발 서버 시작 스크립트
│
├── css/                    # 스타일시트
│   ├── theme.css          # 테마 변수
│   ├── base.css           # 기본 스타일
│   ├── components.css     # 공통 컴포넌트
│   ├── export-modal.css   # 내보내기 모달
│   ├── template.css       # 템플릿 모달
│   └── pages/
│       └── canvas.css     # 캔버스 페이지
│
├── js/                     # JavaScript 모듈
│   ├── pages/
│   │   ├── index.js       # 메인 페이지 로직
│   │   └── canvas.js      # 캔버스 페이지 진입점
│   │
│   ├── canvas/            # 캔버스 관련
│   │   ├── CanvasState.js          # 캔버스 상태 관리
│   │   ├── Person.js               # 인물 클래스
│   │   ├── Relationship.js         # 관계선 클래스
│   │   ├── PersonOperations.js     # 인물 연산
│   │   ├── EmotionalOperations.js  # 감정선 연산
│   │   ├── GenogramRenderer.js     # Genogram 렌더러
│   │   ├── AutoLayout.js           # 자동 정렬
│   │   ├── tools/
│   │   │   └── RelationshipTool.js # 관계선 도구
│   │   └── renderers/
│   │       └── EmotionalRenderer.js # 감정선 렌더러
│   │
│   ├── ui/                # UI 컴포넌트
│   │   ├── Modal.js               # 기본 모달
│   │   ├── Toast.js               # 토스트 알림
│   │   ├── ContextMenu.js         # 우클릭 메뉴
│   │   ├── PersonEditModal.js     # 인물 편집 모달
│   │   ├── settings/
│   │   │   └── SettingsModal.js   # 설정 모달
│   │   ├── export/
│   │   │   ├── ExportModal.js     # 내보내기 모달
│   │   │   ├── components/        # 내보내기 컴포넌트
│   │   │   ├── renderers/         # 프리뷰 렌더러
│   │   │   └── utils/             # 내보내기 유틸리티
│   │   ├── save/
│   │   │   ├── SaveModal.js       # 저장 모달
│   │   │   └── LoadModal.js       # 불러오기 모달
│   │   └── help/
│   │       └── ShortcutsModal.js  # 단축키 도움말
│   │
│   ├── templates/         # 템플릿 시스템
│   │   ├── TemplateData.js        # 템플릿 데이터
│   │   ├── TemplateModal.js       # 템플릿 선택 모달
│   │   ├── TemplateManager.js     # 템플릿 관리자
│   │   └── TutorialManager.js     # 튜토리얼 관리자
│   │
│   ├── export/            # 내보내기
│   │   ├── ExportManager.js       # 내보내기 매니저
│   │   └── ExportManager_SVG_Helper.js
│   │
│   ├── core/              # 핵심 유틸리티
│   │   ├── Utils.js               # 유틸리티 함수
│   │   ├── HistoryManager.js      # 히스토리 관리
│   │   └── EventBus.js            # 이벤트 버스
│   │
│   └── state/             # 상태 관리
│       └── AppState.js            # 앱 전역 상태
│
└── components/            # HTML 컴포넌트
    ├── header.html        # 헤더
    └── footer.html        # 푸터
```

---

## 🛠️ 기술 스택

### 핵심 기술
- **바닐라 JavaScript** (ES6+ Modules)
- **HTML5 Canvas** API
- **CSS3** (CSS Variables)
- **LocalStorage** API

### 외부 라이브러리
- **jsPDF** (2.5.1) - PDF 생성

### 특징
- ✅ **프레임워크 없음** - 순수 JavaScript
- ✅ **빌드 불필요** - HTML 파일 바로 실행
- ✅ **로컬 저장** - 서버 없이 동작
- ✅ **경량** - 핵심 코드 ~180KB

---

## ⌨️ 단축키 가이드

### 도구 전환
| 키 | 도구 |
|----|------|
| `V` | 선택 도구 |
| `H` | 팬 도구 |
| `P` | 인물 추가 |
| `R` | 관계선 추가 |

### 편집
| 키 | 기능 |
|----|------|
| `Delete` / `Backspace` | 선택 항목 삭제 |
| `Ctrl + Z` | 실행 취소 |
| `Ctrl + Shift + Z` | 다시 실행 |
| `Ctrl + C` | 복사 (우클릭 메뉴) |
| `Ctrl + V` | 붙여넣기 (우클릭 메뉴) |

### 캔버스
| 키 | 기능 |
|----|------|
| `스페이스바` + 드래그 | 임시 팬 모드 |
| `마우스 휠` | 줌 인/아웃 |
| `+` / `-` | 줌 버튼 |
| `더블클릭` | 인물 편집 |
| `우클릭` | 컨텍스트 메뉴 |

### 선택
| 키 | 기능 |
|----|------|
| `Ctrl` + 클릭 | 다중 선택 |
| `드래그` | 박스 선택 |

---

## 💡 사용 팁

### 빠른 가계도 작성
1. 템플릿으로 시작하기 (기본 구조 제공)
2. 우클릭 메뉴로 가족 빠르게 추가
3. 자동 정렬로 깔끔하게 배치
4. 감정선으로 관계 표현

### 효율적인 편집
- **멀티 셀렉트**: Ctrl+클릭으로 여러 인물 선택 → 한번에 이동
- **박스 선택**: 드래그로 영역 선택
- **자석 모드**: 그리드에 스냅하여 정렬
- **스페이스바 팬**: 일시적으로 팬 도구로 전환

### 전문적인 가계도
- CT(주요인물) 표시로 중요 인물 강조
- 사망 표시(X)로 세대 구분 명확히
- 감정선으로 가족 역동 표현
- 범례 포함 내보내기로 전문성 향상

---

## 🎯 주요 사용 사례

### 1. 가족치료사
- 내담자 가족 관계 시각화
- 세대 간 패턴 파악
- 치료 계획 수립

### 2. 사회복지사
- 사례 관리 도구
- 가족 구조 분석
- 보고서 작성

### 3. 개인 사용자
- 가족사 기록
- 가계도 작성
- 족보 정리

### 4. 교육
- 가족 체계론 교육
- Genogram 실습
- 사례 연구

---

## 🐛 알려진 제한사항

- **브라우저 지원**: 최신 Chrome, Firefox, Safari, Edge (IE 미지원)
- **저장 방식**: LocalStorage (브라우저 데이터 삭제 시 손실 가능)
- **용량 제한**: LocalStorage 약 5-10MB 제한
- **동시 편집**: 단일 사용자만 지원 (협업 기능 없음)

---

## 📝 버전 정보

**현재 버전**: 1.0.0  
**개발 상태**: ✅ 완성 및 안정화  
**최종 업데이트**: 2024-11-30

---

## 🎉 시작하기

```bash
# 1. 저장소 클론 (또는 다운로드)
git clone [repository-url]

# 2. 서버 실행
cd files
start.bat

# 3. 브라우저에서 자동 실행
# 또는 http://localhost:8000 접속
```

---

## 📄 라이선스

MIT License - 자유롭게 사용, 수정, 배포 가능

---

## 🙏 제작

Claude (Anthropic)와의 협업으로 개발되었습니다.

**행복한 가족 관계도 작성 되세요!** 🎊
