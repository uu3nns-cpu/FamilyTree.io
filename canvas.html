<!DOCTYPE html>
<html lang="ko">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-RWS3BEEQ84"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-RWS3BEEQ84');
  </script>
  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9257454501555292" crossorigin="anonymous"></script>
  
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>캔버스 - 결속 (Gyeolsok)</title>
  <meta name="description" content="가족 관계도를 쉽고 빠르게 제작할 수 있는 캔버스. 전문적인 제노그램 작성을 위한 도구입니다.">
  <meta name="author" content="결속(Gyeolsok)">
  <meta name="copyright" content="Copyright © 2024-2025 결속(Gyeolsok). All Rights Reserved.">
  
  <!-- Open Graph -->
  <meta property="og:title" content="캔버스 - 결속 (Gyeolsok)">
  <meta property="og:description" content="가족 관계도를 쉽고 빠르게 제작할 수 있는 캔버스">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://uu3nns-cpu.github.io/FamilyTree.io/canvas.html">
  
  <!-- Canonical -->
  <link rel="canonical" href="https://uu3nns-cpu.github.io/FamilyTree.io/canvas.html">
  
  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="16x16" href="/FamilyTree.io/favicon-16x16.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/FamilyTree.io/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="48x48" href="/FamilyTree.io/favicon-48x48.png">

  <!-- 테마 초기화 (깜박임 방지) -->
  <script>
    (function() {
      const savedTheme = localStorage.getItem('theme') || 'dark';
      document.documentElement.setAttribute('data-theme', savedTheme);
    })();
  </script>

  <!-- Preload Critical Resources -->
  <link rel="preload" href="css/theme.css" as="style">
  <link rel="preload" href="css/base.css" as="style">
  <link rel="preload" href="css/pages/canvas.css?v=11" as="style">
  <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" as="script" crossorigin="anonymous">
  
  <!-- DNS Prefetch -->
  <link rel="dns-prefetch" href="https://www.googletagmanager.com">
  <link rel="dns-prefetch" href="https://pagead2.googlesyndication.com">
  <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
  
  <!-- CSS -->
  <link rel="stylesheet" href="css/theme.css">
  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/components.css">
  <link rel="stylesheet" href="css/export-modal.css">
  <link rel="stylesheet" href="css/pages/canvas.css?v=11">
  <link rel="stylesheet" href="css/template.css?v=7">
  
  <!-- Shared Header & Footer Styles -->
  <link rel="stylesheet" href="css/shared-header.css">
  <link rel="stylesheet" href="css/shared-footer.css">

  <!-- Cookie Consent -->
  <link rel="stylesheet" href="css/cookie-consent.css">
  <script src="js/cookie-consent.js"></script>

  <!-- jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <style>
    /* Canvas Page Styles */
    body {
      /* overflow는 shared-footer.css에서 처리 */
    }

    .canvas-page {
      display: flex;
      flex-direction: column;
      /* height는 shared-footer.css에서 처리 */
    }

    /* Toolbar */
    .toolbar {
      display: flex;
      align-items: center;
      gap: var(--spacing-2);
      padding: var(--spacing-3) var(--spacing-4);
      background: var(--color-bg-secondary);
      border-bottom: 1px solid var(--color-border-primary);
      height: 56px; /* 툴바 고정 높이 */
      flex-shrink: 0;
    }

    .toolbar__group {
      display: flex;
      gap: var(--spacing-2);
      align-items: center;
    }

    .toolbar__divider {
      width: 1px;
      height: 24px;
      background: var(--color-border-primary);
      margin: 0 var(--spacing-2);
    }

    /* Button SVG Icons */
    .btn svg {
      vertical-align: middle;
      flex-shrink: 0;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }



    /* Canvas Container */
    .canvas-container {
      flex: 1;
      position: relative;
      overflow: hidden;
      background: var(--canvas-bg);
    }

    #genogram-canvas {
      display: block;
      cursor: crosshair;
    }

    /* Tools Panel */
    .tools-panel {
      position: absolute;
      left: var(--spacing-4);
      top: var(--spacing-4);
      background: var(--color-bg-secondary);
      border: 1px solid var(--color-border-primary);
      border-radius: var(--radius-md);
      padding: var(--spacing-3);
      display: flex;
      flex-direction: column;
      gap: var(--spacing-2);
    }

    .tool-btn {
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: transparent;
      border: 1px solid transparent;
      border-radius: var(--radius-sm);
      cursor: pointer;
      font-size: var(--font-size-lg);
      transition: all var(--duration-fast) var(--ease-out);
    }

    .tool-btn:hover {
      background: var(--color-bg-tertiary);
      border-color: var(--color-border-secondary);
    }

    .tool-btn--active {
      background: var(--color-primary);
      border-color: var(--color-primary);
      color: white;
    }

    /* Zoom Controls */
    .zoom-controls {
      position: absolute;
      right: var(--spacing-4);
      bottom: var(--spacing-4);
      background: var(--color-bg-secondary);
      border: 1px solid var(--color-border-primary);
      border-radius: var(--radius-md);
      padding: var(--spacing-2);
      display: flex;
      flex-direction: column;
      gap: var(--spacing-1);
    }

    .zoom-controls__value {
      text-align: center;
      font-size: var(--font-size-sm);
      color: var(--color-text-secondary);
      padding: var(--spacing-1);
    }

    /* Loading Overlay */
    .loading-overlay {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.7);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .loading-overlay--active {
      display: flex;
    }
  </style>
</head>
<body data-page="canvas">
  <!-- Header will be loaded by headerLoader.js -->
  
  <div class="canvas-page">
    <!-- Toolbar -->
    <div class="toolbar">
      <div class="toolbar__group">
        <button class="btn btn--secondary btn--sm" id="btnBack">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 4px;">
            <line x1="19" y1="12" x2="5" y2="12"></line>
            <polyline points="12 19 5 12 12 5"></polyline>
          </svg>
          돌아가기
        </button>
      </div>

      <div style="flex: 1;"></div>

      <div class="toolbar__group">
        <button class="btn btn--secondary btn--sm" id="btnUndo" disabled>
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 4px;">
            <path d="M3 7v6h6"></path>
            <path d="M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"></path>
          </svg>
          실행 취소
        </button>
        <button class="btn btn--secondary btn--sm" id="btnRedo" disabled>
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 4px;">
            <path d="M21 7v6h-6"></path>
            <path d="M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7"></path>
          </svg>
          다시 실행
        </button>
        <div class="toolbar__divider"></div>
        <button class="btn btn--primary btn--sm" id="btnSave">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 4px;">
            <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
            <polyline points="17 21 17 13 7 13 7 21"></polyline>
            <polyline points="7 3 7 8 15 8"></polyline>
          </svg>
          일시저장
        </button>
        <button class="btn btn--secondary btn--sm" id="btnLoad">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 4px;">
            <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
          </svg>
          불러오기
        </button>
        <button class="btn btn--secondary btn--sm" id="btnExport">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 4px;">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
            <polyline points="7 10 12 15 17 10"></polyline>
            <line x1="12" y1="15" x2="12" y2="3"></line>
          </svg>
          내보내기
        </button>
      </div>
    </div>

    <!-- Canvas Container -->
    <div class="canvas-container">
      <canvas id="genogram-canvas"></canvas>



      <!-- Zoom Controls -->
      <div class="zoom-controls">
        <button class="btn btn--sm" id="btnZoomIn">+</button>
        <div class="zoom-controls__value" id="zoomValue">100%</div>
        <button class="btn btn--sm" id="btnZoomOut">−</button>
        <button class="btn btn--sm" id="btnZoomReset" title="초기화">⊙</button>
      </div>



      <!-- Loading Overlay -->
      <div class="loading-overlay" id="loadingOverlay">
        <div class="loading loading--lg"></div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="dashboard-footer"></footer>

  <!-- JavaScript -->
  <script src="js/headerLoader.js"></script>
  <script type="module" src="js/pages/canvas.js?v=13"></script>
</body>
</html>
